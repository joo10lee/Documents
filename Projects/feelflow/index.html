<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="apple-touch-icon" href="./apple-touch-icon.png">
    <meta name="apple-mobile-web-app-title" content="FeelFlow">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <link rel="manifest" href="./manifest.json">
    <link rel="stylesheet" href="css/style.css">

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="js/api.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/activities.js"></script>
    <script src="js/app.js"></script>

    <script>
        window.onload = function () {
            console.log("ğŸš€ FeelFlow ì¸í”„ë¼ Ver.0215-FINAL ê°€ë™");

            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('./sw.js')
                    .then(reg => console.log('ğŸš€ SW Registered!'))
                    .catch(err => console.log('âŒ SW fail:', err));
            }

            if (typeof initApp === 'function') {
                initApp();
            }
        };
    </script>
    <title>FeelFlow - Build Ver.0215-FINAL</title>
</head>

<body>
    <header class="app-header">
        <div class="header-status">
            <span id="weatherIcon">ğŸŒ¤ï¸</span>
            <span class="build-tag">Ver.0215-0030</span>
        </div>
        <div class="header-main">
            <h1 class="greeting">Hey Jason, <br>how's it going?</h1>
        </div>
    </header>

    <button class="hamburger-trigger" onclick="toggleMenu()">
        <div class="bar"></div>
        <div class="bar"></div>
        <div class="bar"></div>
    </button>

    <div id="menuOverlay" class="menu-overlay">
        <button class="menu-close" onclick="toggleMenu()">Ã—</button>
        <nav class="menu-content">
            <button class="menu-item" onclick="menuNavigate('Home', event)">ğŸ  Home</button>
            <button class="menu-item" onclick="menuNavigate('Routine', event)">âœ… Routine</button>
            <button class="menu-item" onclick="menuNavigate('Trophies', event)">ğŸ† Trophies</button>
            <button class="menu-item" onclick="menuNavigate('History', event)">ğŸ“… History</button>
            <button class="menu-item" onclick="menuNavigate('Settings', event)">âš™ï¸ Settings</button>
        </nav>
    </div>

    <main class="screen active" id="screen1">


        <div class="emotion-bento">
            <button class="bento-card happy" onclick="selectEmotion('Happy', 'ğŸ˜Š', '#FFD93D')">
                <span class="emoji">ğŸ˜Š</span> <span class="label">Happy</span>
            </button>
            <button class="bento-card sad" onclick="selectEmotion('Sad', 'ğŸ˜¢', '#6CB4EE')">
                <span class="emoji">ğŸ˜¢</span> <span class="label">Sad</span>
            </button>
            <button class="bento-card anxious" onclick="selectEmotion('Anxious', 'ğŸ˜°', '#A084E8')">
                <span class="emoji">ğŸ˜°</span> <span class="label">Anxious</span>
            </button>
            <button class="bento-card angry" onclick="selectEmotion('Angry', 'ğŸ˜ ', '#FF6B6B')">
                <span class="emoji">ğŸ˜ </span> <span class="label">Angry</span>
            </button>
            <button class="bento-card calm" onclick="selectEmotion('Calm', 'ğŸ˜Œ', '#6BCB77')">
                <span class="emoji">ğŸ˜Œ</span> <span class="label">Calm</span>
            </button>
            <button class="bento-card tired" onclick="selectEmotion('Tired', 'ğŸ˜«', '#95A5A6')">
                <span class="emoji">ğŸ˜«</span> <span class="label">Tired</span>
            </button>
        </div>

        <div class="quick-mission-section">
            <h3 class="section-title">Daily Quest âš”ï¸</h3>
            <div id="quickTaskListContainer" style="overflow-y: auto; max-height: calc(100vh - 450px);">
                <div id="quickTaskList" class="quick-task-grid"></div>
            </div>
        </div>
    </main>

    <main class="screen" id="screen2">
        <div class="intensity-screen">
            <div class="intensity-card">
                <div id="selectedEmoji" style="font-size: 5rem;">ğŸ˜Š</div>
                <div id="selectedName" style="font-size: 1.5rem; font-weight: 850;">Happy</div>
                <p style="margin-top: 20px; color: #64748b;">How strong is this feeling?</p>
                <div class="intensity-display" id="intensityDisplay">5</div>
                <input type="range" min="1" max="10" value="5" class="intensity-slider" id="intensitySlider"
                    oninput="updateIntensity(this.value)">
                <div class="slider-labels">
                    <span>Mild</span>
                    <span>Strong</span>
                </div>
            </div>
            <button class="btn-primary" onclick="goToResult()">Next</button>
            <button class="btn-secondary" onclick="UI.back()">â† Back</button>
        </div>
    </main>

    <main class="screen" id="screen4">
        <div class="result-summary-bar" id="resultSummaryBar">
            <span id="summaryEmoji"></span>
            <span id="summaryText"></span>
        </div>
        <div id="strategiesContainer"></div>
        <div class="strategies-footer">
            <button class="btn btn-secondary" onclick="UI.back()">â† Back</button>
        </div>
    </main>

    <main class="screen" id="screen5">
        <div class="result-card">
            <div class="result-emoji">âœ¨</div>
            <p style="font-size: 1.4rem; font-weight: 800;">Great job, Jason!</p>
            <p id="finalMessage">Mission Recorded Successfully.</p>
            <button class="btn-primary" onclick="startOver()">Finish</button>
        </div>
    </main>

    <main class="screen" id="screenActivity">
        <div class="activity-container">
            <div class="activity-header">
                <div class="activity-icon" id="activityIcon">ğŸ§¸</div>
                <h2 id="activityTitle">Activity</h2>
            </div>
            <div id="inAppActionArea"></div>
            <div class="activity-footer">
                <button class="btn-primary" id="activityBtn" style="display:none;">Save Mission</button>
                <button class="btn btn-secondary" onclick="UI.back()">â† Back</button>
            </div>
        </div>
    </main>

    <main class="screen" id="screenHistory">
        <div class="history-container">
            <h2 class="section-title" style="text-align:center;">Trophy Room</h2>

            <div id="trophyContent"></div>

            <div class="history-card">
                <p style="font-weight:850; margin-bottom:15px;">7-Day Trend</p>
                <div style="height: 180px;"><canvas id="emotionChart"></canvas></div>
            </div>

            <div id="historyList"></div>
        </div>
    </main>

    <main class="screen" id="screenTracker">
        <div class="tracker-container">
            <div class="tracker-tabs">
                <button class="tracker-tab active" id="tabMorning" onclick="switchRoutine('morning')">ğŸŒ…
                    Morning</button>
                <button class="tracker-tab" id="tabEvening" onclick="switchRoutine('evening')">ğŸŒ™ Evening</button>
            </div>
            <div class="progress-card">
                <div class="progress-header">
                    <span id="progressTitle" style="font-weight:850;">Jason's Routine</span>
                    <span id="progressFraction" style="color:#7c3aed; font-weight:850;">0/0</span>
                </div>
                <div class="progress-bar-container">
                    <div id="progressBar" class="progress-bar-fill"></div>
                </div>
            </div>
            <div id="taskList"></div>

        </div>
    </main>
</body>

</html>